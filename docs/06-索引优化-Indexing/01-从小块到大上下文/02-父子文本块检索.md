### 總覽
本範例使用 LangChain 的 `ParentDocumentRetriever` 實現「父子文本塊檢索」：以細粒度子塊建索引提升召回率，命中後回溯到對應的父塊以獲得更完整的回答上下文，最後交給 `RetrievalQA` 生成答案。

### 流程圖
```mermaid
flowchart TD
  D[Document 原文] --> PS[parent_splitter 1000/200]
  D --> CS[child_splitter 200/50]
  CS --> V[Chroma 向量庫]
  PS --> S[InMemoryStore 父文檔存儲]
  V & S --> PR[ParentDocumentRetriever]
  Q[Query] --> QA[RetrievalQA(chain_type=stuff, DeepSeek)]
  PR --> QA --> A[答案 + 源文檔]
```

### 分步講解
- 分塊：父塊 `chunk_size=1000/overlap=200`，子塊 `200/50`。
- 存儲：子塊向量入 `Chroma`，父塊原文入 `InMemoryStore`。
- 檢索：`ParentDocumentRetriever(vectorstore, docstore, child_splitter, parent_splitter)` 命中子塊並返回父塊內容。
- 問答：`RetrievalQA.from_chain_type(..., retriever=retriever, return_source_documents=True)`。

### 關鍵點總結
- **高召回 + 好可讀**：細粒度建索引、粗粒度呈現內容。
- **資料一致性**：新增文檔時務必經由 `retriever.add_documents`，保證父子映射正確。
- **擴展**：可疊加重排或壓縮後處理。


