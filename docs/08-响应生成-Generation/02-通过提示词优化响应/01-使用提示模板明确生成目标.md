### 總覽
以檢索結果為上下文，通過明確格式的提示模板約束輸出，生成結構化的「角色分析報告」，確保內容完整且一致。

### 流程圖
```mermaid
flowchart TD
  TXT[載入與切分文檔] --> V[FAISS 向量庫]
  Q[Query] --> RET[similarity_search]
  RET --> CTX[取 Top1 作 context]
  CTX --> TMP[PromptTemplate(固定欄位)]
  TMP --> LLM[OpenAI]
  LLM --> OUT[角色分析報告]
```

### 分步講解
- 數據準備：載入 `黑悟空/设定.txt`，以 `chunk_size=1000/overlap=200` 切分，建 FAISS。
- 檢索：對查詢檢索相似片段，取第一段作為上下文。
- 模板：明確「人物名稱/背景/技能/策略」等欄位，強化生成一致性。
- 生成：以 `OpenAI` 調用 LLM，輸出報告。

### 關鍵點總結
- **格式先行**：先定欄位與順序，輸出更穩定，便於後續解析。
- **檢索→生成**：保證回答以資料為依據，降低幻覺。


